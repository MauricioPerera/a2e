{
  "catalogId": "workflow-operations-v1",
  "description": "Catálogo de operaciones para ejecución de workflows",
  "operations": {
    "ApiCall": {
      "type": "object",
      "description": "Realiza una llamada HTTP a una API",
      "properties": {
        "method": {
          "type": "string",
          "enum": ["GET", "POST", "PUT", "DELETE", "PATCH"],
          "description": "Método HTTP a usar"
        },
        "url": {
          "type": "string",
          "description": "URL del endpoint. Puede usar variables del data model con {path}"
        },
        "headers": {
          "type": "object",
          "description": "Headers HTTP. Valores pueden ser literales o paths al data model"
        },
        "body": {
          "type": "object",
          "description": "Cuerpo de la petición (para POST/PUT). Puede referenciar data model"
        },
        "outputPath": {
          "type": "string",
          "description": "Ruta en el data model donde guardar la respuesta"
        },
        "timeout": {
          "type": "number",
          "description": "Timeout en milisegundos (opcional)"
        }
      },
      "required": ["method", "url", "outputPath"]
    },
    
    "FilterData": {
      "type": "object",
      "description": "Filtra datos de un array usando condiciones",
      "properties": {
        "inputPath": {
          "type": "string",
          "description": "Ruta al array en el data model"
        },
        "conditions": {
          "type": "array",
          "description": "Lista de condiciones de filtrado",
          "items": {
            "type": "object",
            "properties": {
              "field": {"type": "string"},
              "operator": {
                "type": "string",
                "enum": ["==", "!=", ">", "<", ">=", "<=", "contains", "startsWith", "endsWith"]
              },
              "value": {
                "type": ["string", "number", "boolean", "object"],
                "description": "Valor a comparar. Puede ser literal o path"
              }
            },
            "required": ["field", "operator"]
          }
        },
        "outputPath": {
          "type": "string",
          "description": "Ruta donde guardar el resultado filtrado"
        }
      },
      "required": ["inputPath", "outputPath"]
    },
    
    "TransformData": {
      "type": "object",
      "description": "Transforma datos usando operaciones comunes",
      "properties": {
        "inputPath": {"type": "string"},
        "transform": {
          "type": "string",
          "enum": ["map", "reduce", "sort", "groupBy", "select", "aggregate"],
          "description": "Tipo de transformación"
        },
        "config": {
          "type": "object",
          "description": "Configuración específica de la transformación"
        },
        "outputPath": {"type": "string"}
      },
      "required": ["inputPath", "transform", "outputPath"]
    },
    
    "Conditional": {
      "type": "object",
      "description": "Ejecuta operaciones condicionalmente",
      "properties": {
        "condition": {
          "type": "object",
          "properties": {
            "path": {"type": "string"},
            "operator": {"type": "string", "enum": ["==", "!=", ">", "<", "exists", "isEmpty"]},
            "value": {"type": ["string", "number", "boolean"]}
          }
        },
        "ifTrue": {
          "type": "string",
          "description": "ID de la operación a ejecutar si la condición es verdadera"
        },
        "ifFalse": {
          "type": "string",
          "description": "ID de la operación a ejecutar si la condición es falsa"
        }
      },
      "required": ["condition", "ifTrue"]
    },
    
    "StoreData": {
      "type": "object",
      "description": "Almacena datos en storage local o remoto",
      "properties": {
        "inputPath": {"type": "string"},
        "storage": {
          "type": "string",
          "enum": ["localStorage", "sessionStorage", "indexedDB", "database"],
          "description": "Tipo de almacenamiento"
        },
        "key": {"type": "string"},
        "format": {
          "type": "string",
          "enum": ["json", "string", "binary"],
          "description": "Formato de almacenamiento"
        }
      },
      "required": ["inputPath", "storage", "key"]
    },
    
    "Wait": {
      "type": "object",
      "description": "Espera un tiempo antes de continuar",
      "properties": {
        "duration": {
          "type": "number",
          "description": "Duración en milisegundos"
        }
      },
      "required": ["duration"]
    },
    
    "Loop": {
      "type": "object",
      "description": "Ejecuta operaciones en un loop",
      "properties": {
        "inputPath": {
          "type": "string",
          "description": "Ruta al array sobre el que iterar"
        },
        "operations": {
          "type": "array",
          "description": "IDs de operaciones a ejecutar por cada item",
          "items": {"type": "string"}
        },
        "outputPath": {
          "type": "string",
          "description": "Ruta donde guardar resultados del loop"
        }
      },
      "required": ["inputPath", "operations"]
    },
    
    "MergeData": {
      "type": "object",
      "description": "Combina datos de múltiples fuentes",
      "properties": {
        "sources": {
          "type": "array",
          "description": "Rutas a los datos a combinar",
          "items": {"type": "string"}
        },
        "strategy": {
          "type": "string",
          "enum": ["merge", "concat", "intersect", "union"],
          "description": "Estrategia de combinación"
        },
        "outputPath": {"type": "string"}
      },
      "required": ["sources", "strategy", "outputPath"]
    },
    
    "GetCurrentDateTime": {
      "type": "object",
      "description": "Obtiene la fecha y hora actual en formato ISO 8601",
      "properties": {
        "timezone": {
          "type": "string",
          "description": "Zona horaria (ej: 'UTC', 'America/New_York', 'Europe/Madrid'). Si no se especifica, usa la zona horaria del sistema"
        },
        "format": {
          "type": "string",
          "enum": ["iso8601", "timestamp", "custom"],
          "description": "Formato de salida. 'iso8601' (default): formato ISO 8601, 'timestamp': Unix timestamp en segundos, 'custom': usar formatString"
        },
        "formatString": {
          "type": "string",
          "description": "Formato personalizado (solo si format='custom'). Usa formato strftime de Python"
        },
        "outputPath": {
          "type": "string",
          "description": "Ruta en el data model donde guardar la fecha/hora"
        }
      },
      "required": ["outputPath"]
    },
    
    "ConvertTimezone": {
      "type": "object",
      "description": "Convierte una fecha/hora de una zona horaria a otra",
      "properties": {
        "inputPath": {
          "type": "string",
          "description": "Ruta a la fecha/hora en el data model. Puede ser ISO 8601 string, Unix timestamp, o objeto con campos date/time"
        },
        "fromTimezone": {
          "type": "string",
          "description": "Zona horaria de origen (ej: 'UTC', 'America/New_York'). Si no se especifica, se intenta detectar o usar UTC"
        },
        "toTimezone": {
          "type": "string",
          "description": "Zona horaria de destino (ej: 'Europe/Madrid', 'America/Los_Angeles')"
        },
        "format": {
          "type": "string",
          "enum": ["iso8601", "timestamp", "custom"],
          "description": "Formato de salida. 'iso8601' (default): formato ISO 8601, 'timestamp': Unix timestamp, 'custom': usar formatString"
        },
        "formatString": {
          "type": "string",
          "description": "Formato personalizado (solo si format='custom'). Usa formato strftime de Python"
        },
        "outputPath": {
          "type": "string",
          "description": "Ruta en el data model donde guardar la fecha/hora convertida"
        }
      },
      "required": ["inputPath", "toTimezone", "outputPath"]
    },
    
    "DateCalculation": {
      "type": "object",
      "description": "Realiza cálculos con fechas (sumar días, restar horas, etc.)",
      "properties": {
        "inputPath": {
          "type": "string",
          "description": "Ruta a la fecha base en el data model. Puede ser ISO 8601 string, Unix timestamp, o objeto con campos date/time"
        },
        "operation": {
          "type": "string",
          "enum": ["add", "subtract"],
          "description": "Operación a realizar: 'add' para sumar, 'subtract' para restar"
        },
        "years": {
          "type": "number",
          "description": "Años a sumar/restar (opcional)"
        },
        "months": {
          "type": "number",
          "description": "Meses a sumar/restar (opcional)"
        },
        "days": {
          "type": "number",
          "description": "Días a sumar/restar (opcional)"
        },
        "hours": {
          "type": "number",
          "description": "Horas a sumar/restar (opcional)"
        },
        "minutes": {
          "type": "number",
          "description": "Minutos a sumar/restar (opcional)"
        },
        "seconds": {
          "type": "number",
          "description": "Segundos a sumar/restar (opcional)"
        },
        "timezone": {
          "type": "string",
          "description": "Zona horaria para la fecha base si no está especificada (opcional)"
        },
        "format": {
          "type": "string",
          "enum": ["iso8601", "timestamp", "custom"],
          "description": "Formato de salida. 'iso8601' (default): formato ISO 8601, 'timestamp': Unix timestamp, 'custom': usar formatString"
        },
        "formatString": {
          "type": "string",
          "description": "Formato personalizado (solo si format='custom'). Usa formato strftime de Python"
        },
        "outputPath": {
          "type": "string",
          "description": "Ruta en el data model donde guardar el resultado del cálculo"
        }
      },
      "required": ["inputPath", "operation", "outputPath"]
    },
    
    "FormatText": {
      "type": "object",
      "description": "Formatea texto usando plantillas o transformaciones",
      "properties": {
        "inputPath": {
          "type": "string",
          "description": "Ruta al texto o datos en el data model"
        },
        "format": {
          "type": "string",
          "enum": ["template", "upper", "lower", "title", "capitalize", "trim", "replace"],
          "description": "Tipo de formateo a aplicar"
        },
        "template": {
          "type": "string",
          "description": "Plantilla de formato (solo si format='template'). Usa {field} para variables"
        },
        "replacements": {
          "type": "object",
          "description": "Reemplazos para format='replace'. Clave: texto a buscar, Valor: texto de reemplazo"
        },
        "outputPath": {
          "type": "string",
          "description": "Ruta donde guardar el texto formateado"
        }
      },
      "required": ["inputPath", "format", "outputPath"]
    },
    
    "ExtractText": {
      "type": "object",
      "description": "Extrae información de texto usando expresiones regulares o patrones",
      "properties": {
        "inputPath": {
          "type": "string",
          "description": "Ruta al texto en el data model"
        },
        "pattern": {
          "type": "string",
          "description": "Expresión regular o patrón para extraer"
        },
        "extractAll": {
          "type": "boolean",
          "description": "Si extraer todas las coincidencias (true) o solo la primera (false)"
        },
        "outputPath": {
          "type": "string",
          "description": "Ruta donde guardar los resultados extraídos"
        }
      },
      "required": ["inputPath", "pattern", "outputPath"]
    },
    
    "ValidateData": {
      "type": "object",
      "description": "Valida datos usando reglas predefinidas (email, URL, número, etc.)",
      "properties": {
        "inputPath": {
          "type": "string",
          "description": "Ruta a los datos a validar en el data model"
        },
        "validationType": {
          "type": "string",
          "enum": ["email", "url", "number", "integer", "phone", "date", "custom"],
          "description": "Tipo de validación a aplicar"
        },
        "pattern": {
          "type": "string",
          "description": "Expresión regular para validación custom (solo si validationType='custom')"
        },
        "outputPath": {
          "type": "string",
          "description": "Ruta donde guardar el resultado de validación (true/false o objeto con detalles)"
        }
      },
      "required": ["inputPath", "validationType", "outputPath"]
    },
    
    "Calculate": {
      "type": "object",
      "description": "Realiza cálculos matemáticos",
      "properties": {
        "inputPath": {
          "type": "string",
          "description": "Ruta a los números o expresión en el data model"
        },
        "operation": {
          "type": "string",
          "enum": ["add", "subtract", "multiply", "divide", "power", "modulo", "round", "ceil", "floor", "abs", "max", "min", "sum", "average"],
          "description": "Operación matemática a realizar"
        },
        "operand": {
          "type": ["number", "string"],
          "description": "Segundo operando (para operaciones binarias) o path al segundo operando"
        },
        "precision": {
          "type": "number",
          "description": "Precisión decimal para redondeo (solo si operation='round')"
        },
        "outputPath": {
          "type": "string",
          "description": "Ruta donde guardar el resultado del cálculo"
        }
      },
      "required": ["inputPath", "operation", "outputPath"]
    },
    
    "EncodeDecode": {
      "type": "object",
      "description": "Codifica o decodifica datos (Base64, URL encoding, etc.)",
      "properties": {
        "inputPath": {
          "type": "string",
          "description": "Ruta a los datos en el data model"
        },
        "operation": {
          "type": "string",
          "enum": ["encode", "decode"],
          "description": "Codificar o decodificar"
        },
        "encoding": {
          "type": "string",
          "enum": ["base64", "url", "html"],
          "description": "Tipo de codificación a usar"
        },
        "outputPath": {
          "type": "string",
          "description": "Ruta donde guardar el resultado"
        }
      },
      "required": ["inputPath", "operation", "encoding", "outputPath"]
    }
  }
}

